import pandas as pd

pd.set_option('display.max.columns',100)
##sources of file 
df = pd.read_excel(r'Excel/Datafile.xlsx')
cat = pd.read_excel(r'Excel/DiscriptionCategories.xlsx')

## delete some columns from the table 
##df = df.drop(columns=['Account Number','Balance','Transaction Type','Sort Code'])
cat = cat.drop(columns=['Counts'])

##show first (default 5) column of table 
df.head()

## change data type into string 
df['TransactionDescription'] = df['TransactionDescription'].apply(str)

MergeTable = pd.merge(df,
                        cat,
                        on = 'TransactionDescription',
                        how = 'outer')
MergeTable.head()
## set column as index 
MergeTable.set_index('TransactionDescription')

MergeTable.groupby(['Categories'],as_index = True).agg({'DebitAmount':'sum','CreditAmount':'sum'}).plot(kind='pie',y='DebitAmount',title = 'Total Expenses',startangle=60)
